!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.Architect=e():t.Architect=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var n,o,s,u,i,p;for(o={},i=["ajax","jsonp"],s=0,u=i.length;u>s;s++)p=i[s],o[p]=r(1)("./"+p+"_worker_polyfill.coffee");n=function(){function t(t){var e,r,n;e=null!=t?t:{},r=e.workersPath,n=e.workersSuffix,this.jobs={},this.workersPath=r||"/workers",this.workersSuffix=n||"_worker.min.js"}return t.prototype.spawnWorker=function(t){return this.workersAreSupported()?new Worker(this.getWorkersPathForType(t)):this.getPolyfillForType(t)},t.prototype.getWorkersPathForType=function(t){return this.workersPath+"/"+t+this.workersSuffix},t.prototype.getPolyfillForType=function(t){return new o[t]},t.prototype.workersAreSupported=function(){return null!=this.workersSupported?this.workersSupported:this.workersSupported=!!window.Worker},t.prototype.work=function(t,e){return new Promise(function(r){return function(n){var o;return o=r.spawnWorker(e),o.postMessage(t),o.addEventListener("message",function(t){return o.terminate(),n(t.data)})}}(this))},t.prototype.jsonp=function(t,e){return null==e&&(e={}),"string"==typeof t&&(t={url:t}),this.work(t,"jsonp")},t.prototype.ajax=function(t){var e,r;return null==t&&(t={}),r=t.success,e=t.error,delete t.success,delete t.error,new Promise(function(n){return function(o,s){return n.work(t,"ajax").then(function(t){return"success"in t?(o(t.success),"function"==typeof r?r(t.success):void 0):"error"in t?(s(t.error),"function"==typeof e?e(t.error):void 0):void 0})}}(this))},t}(),t.exports=n},function(t,e,r){function n(t){return r(o(t))}function o(t){return s[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var s={"./ajax_worker_polyfill.coffee":2,"./jsonp_worker_polyfill.coffee":3};n.keys=function(){return Object.keys(s)},n.resolve=o,t.exports=n,n.id=1},function(t,e,r){var n,o,s=function(t,e){function r(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},u={}.hasOwnProperty;o=r(4),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.handleSuccess=function(t){return this.handleRequest({success:t})},e.prototype.handleError=function(t){return this.handleRequest({error:t})},e.prototype.postMessage=function(t){var e,r,n,o,s,u,i,p,a;u=t,i=u.type,p=u.url,t=u.data,r=u.dataType,e=u.contentType,s=u.headers,i||(i="GET"),s||(s={}),s["X-Requested-With"]="XMLHttpRequest",e!==!1&&(s["Content-Type"]=e||"application/x-www-form-urlencoded"),a=new XMLHttpRequest,a.open(i,p);for(n in s)o=s[n],a.setRequestHeader(n,o);return a.onreadystatechange=function(t){return function(){var e,n;if(4===a.readyState){if(a.status>=200&&a.status<300||304===a.status){n=a.responseText;try{"script"===r?(1,eval)(n):"xml"===r?n=a.responseXML:"json"===r&&(n=/^\s*$/.test(n)?null:JSON.parse(n))}catch(o){e=o}return e?t.handleError(a):t.handleSuccess(n)}return t.handleError(a)}}}(this),a.send(t)},e}(o),t.exports=n},function(t,e,r){var n,o,s=function(t,e){function r(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},u={}.hasOwnProperty;o=r(4),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.postMessage=function(t){var e,r,n,o;return o=t.url,e=t.callbackAttribute,r=t.callbackFnName,void 0===e&&(e="callback"),void 0===r&&(this.jsonpID||(this.jsonpID=0),r="architect_jsonp"+ ++this.jsonpID),window[r]=function(t){return function(e){return delete window[r],t.removeScript(),t.handleRequest(e)}}(this),n=e?this.appendQuery(o,e+"="+r):o,this.addScript(n)},e.prototype.addScript=function(t){return this.tmpScript=document.createElement("script"),this.tmpScript.src=t,document.head.appendChild(this.tmpScript)},e.prototype.removeScript=function(){return document.head.removeChild(this.tmpScript)},e.prototype.appendQuery=function(t,e){return(t+"&"+e).replace(/[&?]{1,2}/,"?")},e}(o),t.exports=n},function(t){var e;e=function(){function t(){this.callbacks={},this.callbacksQueue={}}return t.prototype.addEventListener=function(t,e){var r;return this.callbacks[t]=e,(r=this.callbacksQueue[t])?(delete this.callbacksQueue[t],this.dispatch(t,r)):void 0},t.prototype.dispatch=function(t,e){return this.callbacks[t]?this.callbacks[t]({data:e}):this.callbacksQueue[t]=e},t.prototype.handleRequest=function(t){return this.dispatch("message",t)},t.prototype.postMessage=function(){},t.prototype.terminate=function(){},t}(),t.exports=e}])});