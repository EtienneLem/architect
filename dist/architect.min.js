!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Architect=t():e.Architect=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var s=r[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){var n,s=function(e,t){return function(){return e.apply(t,arguments)}};n=function(){function e(){this.handleMessage=s(this.handleMessage,this),this.jobs={},this.workers={}}return e.prototype.spawnWorker=function(e){var t,n,s,o,i,a,u,c,p,l,f;c=null!=e?e:{},p=c.type,o=c.data,a=c.fn;try{l=r(1)("./"+p)}catch(e){if(i=e,!a)throw new Error("Unkown worker type “"+p+"” and no fn provided");l=r(3)}return this.workersAreSupported()?(u=a?"work = "+a.toString()+";":"",f="("+l.toString()+")()",n=new Blob([u,f]),s=window.URL.createObjectURL(n),new Worker(s)):new(t=r(5))(l,a)},e.prototype.workersAreSupported=function(e){return null==e&&(e=window),null!=this.workersSupported?this.workersSupported:this.workersSupported="Worker"in e},e.prototype.requireParams=function(e,t){var r,n,s,o,i,a,u,c,p;for(null==t&&(t={}),i=[],Array.isArray(e)||(e=[e]),r=0,s=e.length;r<s;r++)if(u=e[r],!(u in t))if((p=u.split(/\s?\|\|\s?/)).length>1){for(a=[],n=0,o=p.length;n<o;n++)c=p[n],c in t&&a.push(c);a.length||i.push(u)}else i.push(u);if(i.length)throw new Error("Missing required “"+i.join(", ")+"” parameter"+(i.length>1?"s":""))},e.prototype.getJobId=function(){return this.jobId||(this.jobId=1),this.jobId++},e.prototype.work=function(e){var t,r,n,s;return n=null!=e?e:{},s=n.type,t=n.data,r=n.fn,this.requireParams("type",arguments[0]),new Promise(function(e){return function(n,o){var i,a;return i=e.getJobId(),e.jobs[i]={id:i,resolve:n,reject:o},(a=e.workers[s])||(a=e.spawnWorker({type:s,data:t,fn:r}),a.addEventListener("message",e.handleMessage),e.workers[s]=a),a.postMessage({id:i,args:t})}}(this))},e.prototype.handleMessage=function(e){var t,r,n,s,o;return n=e.data,t=n.id,o=n.resolve,s=n.reject,r=this.jobs[t],delete this.jobs[t],"resolve"in e.data?r.resolve(o):r.reject(s)},e.prototype.jsonp=function(e){return null==e&&(e={}),"string"==typeof e&&(e={url:e}),this.requireParams("url",e),this.work({data:e,type:"jsonp"})},e.prototype.ajax=function(e){var t,r,n;return null==e&&(e={}),this.requireParams("url",e),n=e.success,t=e.error,r=JSON.parse(JSON.stringify(e)),delete r.success,delete r.error,new Promise(function(e){return function(s,o){return e.work({data:r,type:"ajax"}).then(function(e){return s(e),"function"==typeof n?n(e):void 0}).catch(function(e){return o(e),"function"==typeof t?t(e):void 0})}}(this))},e}(),e.exports=n},function(e,t,r){function n(e){return r(s(e))}function s(e){return o[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var o={"./ajax":2,"./ajax.coffee":2,"./custom":3,"./custom.coffee":3,"./jsonp":4,"./jsonp.coffee":4,"./polyfill":5,"./polyfill.coffee":5};n.keys=function(){return Object.keys(o)},n.resolve=s,e.exports=n,n.id=1},function(e,t){e.exports=function(){var e,t;return t=function(e){return function(t,r){return e.postMessage({id:t,resolve:r})}}(this),e=function(e){return function(t,r,n){var s,o,i,a,u,c,p;for(p={},u=["response","responseType","responseText","responseXML","responseURL","status","statusText","withCredentials","readyState","timeout"],o=0,a=u.length;o<a;o++)i=u[o],p[i]=r[i];try{"json"===n&&(c=p.response,p.response=/^\s*$/.test(c)?null:JSON.parse(c))}catch(e){s=e}return e.postMessage({id:t,reject:p})}}(this),this.onmessage=function(r){var n,s,o,i,a,u,c,p,l,f,d,h;l=r.data,p=l.id,n=l.args,f=n.type,d=n.url,o=n.data,i=n.dataType,s=n.contentType,c=n.headers,f||(f="GET"),c||(c={}),null==c["X-Requested-With"]&&(c["X-Requested-With"]="XMLHttpRequest"),s!==!1&&(c["Content-Type"]=s||"application/x-www-form-urlencoded"),h=new XMLHttpRequest,h.open(f,d),"withCredentials"in n&&(h.withCredentials=n.withCredentials);for(a in c)u=c[a],u&&h.setRequestHeader(a,u);return h.onreadystatechange=function(r){var n,s;if(4===h.readyState){if(h.status>=200&&h.status<300||304===h.status){s=h.responseText;try{"script"===i?(0,eval)(s):"xml"===i?s=h.responseXML:"json"===i&&(s=/^\s*$/.test(s)?null:JSON.parse(s))}catch(e){n=e}return n?e(p,h,i):t(p,s)}return e(p,h,i)}},h.send(o)}}},function(module,exports){module.exports=function(){return this.onmessage=function(_this){return function(e){var args,id,ref,result;return ref=e.data,id=ref.id,args=ref.args,_this.fn?("string"==typeof _this.fn&&(_this.fn=eval("this._fn = "+_this.fn)),result=_this.fn(args)):result=work(args),result instanceof Promise?result.then(function(e){return _this.postMessage({id:id,resolve:e})}).catch(function(e){return _this.postMessage({id:id,reject:e})}):_this.postMessage({id:id,resolve:result})}}(this)}},function(e,t){var r;r=self,e.exports=function(){var e;return e=function(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")},this.onmessage=function(t){var n,s,o,i,a,u,c,p;u=t.data,a=u.id,n=u.args,p=n.url,s=n.callbackAttribute,o=n.callbackFnName,void 0===s&&(s="callback"),void 0===o&&(o="handleRequest"),c=s?e(p,s+"="+o):p,"undefined"==typeof r&&(r=self),r[o]=function(e){return function(){return delete r[o],"function"==typeof e.removeScripts&&e.removeScripts(c),n=[].slice.call(arguments),n=n.length>1?n:n[0],e.postMessage({id:a,resolve:n})}}(this);try{return this.importScripts(c)}catch(e){return i=e,this.postMessage({id:a,reject:{message:i.message,code:i.code,name:i.name}})}}}},function(e,t){var r;r=function(){function e(e,t){this.fn=t,this.jobs={},this.scripts={},this.callbacks={},this.callbacksQueue={},e.call(this)}return e.prototype.addEventListener=function(e,t){var r;if(this.callbacks[e]=t,r=this.callbacksQueue[e])return delete this.callbacksQueue[e],this.dispatch(e,r)},e.prototype.dispatch=function(e,t){return this.callbacks[e]?this.callbacks[e]({data:t}):this.callbacksQueue[e]=t},e.prototype.handleRequest=function(e){return this.dispatch("message",e)},e.prototype.postMessage=function(e){return this.jobs[e.id]?this.dispatch("message",e):(this.jobs[e.id]=e,this.onmessage({data:e}))},e.prototype.importScripts=function(e){var t;return t=document.createElement("script"),t.src=e,document.head.appendChild(t),this.scripts[e]=t},e.prototype.removeScripts=function(e){var t;if(t=this.scripts[e])return delete this.scripts[e],document.head.removeChild(t)},e.prototype.terminate=function(){},e}(),e.exports=r}])});